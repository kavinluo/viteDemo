!function(){if(!window.ymPrompt){var objType=function(t){return new Function("o","return Object.prototype.toString.call(o)=='[object "+t+"]'")},isArray=objType("Array"),isObj=objType("Object");window.ymPrompt={version:"4.0",pubDate:"2009-03-02",apply:function(t,e,n){if(n&&ymPrompt.apply(t,n),t&&e&&isObj(e))for(var i in e)t[i]=e[i];return t},eventList:[]};for(var initFn=["setDefaultCfg","show"],_initFn={},t;t=initFn.shift();)ymPrompt[t]=eval("0,function(){_initFn."+t+"?_initFn."+t+".push(arguments):(_initFn."+t+"=[arguments])}");var isIE=!1,isCompat="CSS1Compat"==document.compatMode,IE6=isIE&&/MSIE (\d)\./.test(navigator.userAgent)&&parseInt(RegExp.$1)<7,useFixed=!isIE||!IE6&&isCompat,$=function(t){return document.getElementById(t)},$height=function(t){return parseInt(t.style.height)||t.offsetHeight},addEvent=new Function("env","fn","obj","obj=obj||document;"+(window.attachEvent?"obj.attachEvent('on'+env,fn)":"obj.addEventListener(env,fn,false)")+";ymPrompt.eventList.push([env,fn,obj])"),detachEvent=new Function("env","fn","obj","obj=obj||document;"+(window.attachEvent?"obj.detachEvent('on'+env,fn)":"obj.removeEventListener(env,fn,false)")),setStyle=function(t,e,n){if(t)if(isObj(e))for(var i in e)setStyle(t,i,e[i]);else if(isArray(t)||/htmlcollection|nodelist/i.test(""+t))for(i=t.length-1;i>=0;i--)setStyle(t[i],e,n);else try{t.style[e]=n}catch(t){}},btnIndex=0,btnCache,seed=0,mkBtn=function(t,e,n,i){if(t){if(isArray(t)){for(var o,r=[],a={OK:[curCfg.okTxt,"ok"],CANCEL:[curCfg.cancelTxt,"cancel"]};t.length;)(o=t.shift())&&r[r.push(mkBtn.apply(null,a[o]||o))-1]||r.pop();return r}return{id:i=i||"ymPrompt_btn_"+seed++,html:"<input type='button' id='"+i+"' onclick='ymPrompt.doHandler(\""+e+'",'+(n=null==n?"undefined":!!n)+")' style='cursor:pointer' class='btnStyle handler' value='"+t+"' />"}}},joinBtn=function(t){if(!t)return btnCache="";if(isArray(t)||(t=[t]),!t.length)return btnCache="";btnCache=t.concat();for(var e=[];t.length;)e.push(t.shift().html);return e.join("&nbsp;&nbsp;")},dftCfg={message:"内容",width:300,height:185,title:"标题",handler:function(){},maskAlphaColor:"#000",maskAlpha:.1,iframe:!1,icoCls:"",btn:null,autoClose:!0,fixPosition:!0,dragOut:!0,titleBar:!0,showMask:!0,winPos:"c",winAlpha:.8,closeBtn:!0,showShadow:!1,useSlide:!1,slideCfg:{increment:.3,interval:50},closeTxt:"关闭",okTxt:" 确 定 ",cancelTxt:" 取 消 ",msgCls:"ym-content",minBtn:!1,minTxt:"最小化",maxBtn:!1,maxTxt:"最大化",allowSelect:!1,allowRightMenu:!1},curCfg={};!function(){var rootEl=document.body,callee=arguments.callee;if(!rootEl||"object"!=typeof rootEl)return addEvent("load",callee,window);if(isIE&&"complete"!=document.readyState)return addEvent("readystatechange",function(){"complete"==document.readyState&&callee()});rootEl=isCompat?document.documentElement:rootEl;var frameset=document.getElementsByTagName("frameset").length;if(isIE||!frameset){var getScrollPos=function(){return curCfg.fixPosition&&useFixed?[0,0]:[rootEl.scrollLeft,rootEl.scrollTop]},saveWinInfo=function(){var t=getScrollPos();ymPrompt.apply(dragVar,{_offX:parseInt(ym_win.style.left)-t[0],_offY:parseInt(ym_win.style.top)-t[1]})},maskStyle="position:absolute;top:0;left:0;display:none;text-align:center",div=document.createElement("div");div.innerHTML=["<div id='maskLevel' style='"+maskStyle+";z-index:10000;'></div>",IE6?"<iframe id='maskIframe' src='javascript:false' style='"+maskStyle+";z-index:9999;filter:alpha(opacity=0);opacity:0'></iframe>":"","<div id='ym-window' style='position:absolute;z-index:10001;display:none;background:none'>",IE6?" ":"","<div class='ym-tl' id='ym-tl'><div class='ym-tr'><div class='ym-tc' style='cursor:move;'><div class='ym-header-text'></div><div class='ym-header-tools'>","<div class='ymPrompt_min' title='最小化'><strong>0</strong></div>","<div class='ymPrompt_max' title='最大化'><strong>1</strong></div>","<div class='ymPrompt_close' title='关闭'><strong>r</strong></div>","</div></div></div></div>","<div class='ym-ml' id='ym-ml'><div class='ym-mr'><div class='ym-mc'><div id='ym-bodyId' class='ym-body' style='position:relative'></div></div></div></div>","<div class='ym-ml' id='ym-btnl'><div class='ym-mr'><div class='ym-btn'></div></div></div>","<div class='ym-bl' id='ym-bl'><div class='ym-br'><div class='ym-bc'></div></div></div>","</div>",isIE?"<div id='ym-shadow' style='position:absolute;z-index:10000;background:#808080;filter:alpha(opacity=80) progid:DXImageTransform.Microsoft.Blur(pixelradius=2);display:none'></div>":""].join(""),document.body.appendChild(div);var maskLevel=$("maskLevel"),ym_win=$("ym-window"),ym_shadow=$("ym-shadow"),ym_wins,ym_headbox=$("ym-tl"),ym_head=ym_headbox.firstChild.firstChild,ym_hText=ym_head.firstChild,ym_hTool=ym_hText.nextSibling,ym_body=$("ym-ml").firstChild.firstChild.firstChild,ym_btn=$("ym-btnl"),ym_btnContent=ym_btn.firstChild.firstChild,ym_bottom=$("ym-bl"),maskEl=[maskLevel];IE6&&maskEl.push($("maskIframe"));var ym_ico=ym_hTool.childNodes,dragVar={},cur_state="normal",cur_cord=[0,0],cal_cord=function(){var t=getScrollPos();cur_cord=[parseInt(ym_win.style.left)-t[0],parseInt(ym_win.style.top)-t[1]]},doMax=function(){cal_cord(),cur_state="max",ym_ico[1].firstChild.innerHTML="2",ym_ico[1].className="ymPrompt_normal",setWinSize(rootEl.clientWidth,rootEl.clientHeight,[0,0])},doMin=function(){cal_cord(),cur_state="min",ym_ico[0].firstChild.innerHTML="2",ym_ico[0].className="ymPrompt_normal",setWinSize(0,$height(ym_headbox),cur_cord)},doNormal=function(t){!t&&"min"==cur_state&&cal_cord(),cur_state="normal",ym_ico[0].firstChild.innerHTML="0",ym_ico[1].firstChild.innerHTML="1",ym_ico[0].className="ymPrompt_min",ym_ico[1].className="ymPrompt_max",setWinSize.apply(this,t?[]:[0,0,cur_cord])},max,min;addEvent("click",min=function(){"normal"!=cur_state?doNormal():doMin()},ym_ico[0]),addEvent("click",max=function(){"normal"!=cur_state?doNormal():doMax()},ym_ico[1]),addEvent("dblclick",function(t){curCfg.maxBtn&&(t.srcElement||t.target).parentNode!=ym_hTool&&max()},ym_head),addEvent("click",function(){ymPrompt.doHandler("close")},ym_ico[2]);var getWinSize=function(){return[Math.max(rootEl.scrollWidth,rootEl.clientWidth),Math.max(rootEl.scrollHeight,rootEl.clientHeight)]},winSize=getWinSize(),bindEl=ym_head.setCapture&&ym_head,filterWin=function(t){!frameset&&setStyle(ym_win,1==t&&isCompat?{filter:"",opacity:""}:{filter:isIE?"":"Alpha(opacity="+100*t+")",opacity:t})},mEvent=function(t){var e=dragVar.offX+t.clientX,n=dragVar.offY+t.clientY;if(curCfg.dragOut)curCfg.showMask&&""+winSize!=""+getWinSize()&&resizeMask(!0);else{var i=getScrollPos(),o=i[0],r=i[1];e=Math.min(Math.max(e,o),rootEl.clientWidth-ym_win.offsetWidth+o),n=Math.min(Math.max(n,r),rootEl.clientHeight-ym_win.offsetHeight+r)}e>0?rootEl.clientWidth-e<100&&(e=rootEl.clientWidth-100):ym_win.offsetWidth+getScrollPos()[0]+e<100&&(e=100-ym_win.offsetWidth+getScrollPos()[0]),n<0?n=0:rootEl.clientHeight-n<30&&(n=rootEl.clientHeight-30),setStyle(ym_wins,{left:e+"px",top:n+"px"})},uEvent=function(){filterWin(1),detachEvent("mousemove",mEvent,bindEl),detachEvent("mouseup",uEvent,bindEl),saveWinInfo(),curCfg.iframe&&setStyle(getPage().nextSibling,"display","none"),bindEl&&(detachEvent("losecapture",uEvent,bindEl),bindEl.releaseCapture())};addEvent("mousedown",function(t){if((t.srcElement||t.target).parentNode==ym_hTool)return!1;if(filterWin(curCfg.winAlpha),ymPrompt.apply(dragVar,{offX:parseInt(ym_win.style.left)-t.clientX,offY:parseInt(ym_win.style.top)-t.clientY}),addEvent("mousemove",mEvent,bindEl),addEvent("mouseup",uEvent,bindEl),curCfg.iframe){var e={display:""},n=getPage();isCompat&&IE6&&ymPrompt.apply(e,{width:n.offsetWidth,height:n.offsetHeight}),setStyle(n.nextSibling,e)}bindEl&&(addEvent("losecapture",uEvent,bindEl),bindEl.setCapture())},ym_head);var scrollEvent=function(){setStyle(ym_win,{left:dragVar._offX+rootEl.scrollLeft+"px",top:dragVar._offY+rootEl.scrollTop+"px"})},keydownEvent=function(t){var e=t.keyCode;if(27==e&&destroy(),btnCache){var n,i=btnCache.length;if(document.activeElement&&document.activeElement.id!=btnCache[btnIndex].id&&(n=!0),9!=e&&39!=e||(n&&(btnIndex=-1),$(btnCache[++btnIndex==i?--btnIndex:btnIndex].id).focus()),37==e&&(n&&(btnIndex=i),$(btnCache[--btnIndex<0?++btnIndex:btnIndex].id).focus()),13==e)return!0}return keyEvent(t,e>110&&e<123||9==e||13==e)},keyEvent=function(t,e){if(t=t||event,!e&&/input|select|textarea/i.test((t.srcElement||t.target).tagName))return!0;try{t.returnValue=!1,t.keyCode=0}catch(e){t.preventDefault&&t.preventDefault()}return!1};maskLevel.oncontextmenu=keyEvent;var resizeMask=function(t){setStyle(maskEl,"display","none");var e=getWinSize(),n=function(){setStyle(maskEl,{width:e[0]+"px",height:e[1]+"px",display:""})};isIE?!0===t?n():setTimeout(n,0):n(),"min"==cur_state?doMin():"max"==cur_state?doMax():setWinSize()},maskVisible=function(t){if(curCfg.showMask){if((!1===t?detachEvent:addEvent)("resize",resizeMask,window),!1===t)return setStyle(maskEl,"display","none");setStyle(maskLevel,{background:curCfg.maskAlphaColor,filter:"Alpha(opacity="+100*curCfg.maskAlpha+")",opacity:curCfg.maskAlpha}),resizeMask(!0)}},getPos=function(f){f=isArray(f)&&2==f.length?f[0]+"+{2},{3}+"+f[1]:posMap[f]||posMap.c;var pos=[rootEl.clientWidth-ym_win.offsetWidth,rootEl.clientHeight-ym_win.offsetHeight].concat(getScrollPos()),arr=f.replace(/\{(\d)\}/g,function(t,e){return pos[e]}).split(",");return[eval(arr[0]),eval(arr[1])]},posMap={c:"{0}/2+{2},{1}/2+{3}",l:"{2},{1}/2+{3}",r:"{0}+{2},{1}/2+{3}",t:"{0}/2+{2},{3}",b:"{0}/2,{1}+{3}",lt:"{2},{3}",lb:"{2},{1}+{3}",rb:"{0}+{2},{1}+{3}",rt:"{0}+{2},{3}"},setWinSize=function(t,e,n){"none"!=ym_win.style.display&&(e=parseInt(e)||curCfg.height,t=parseInt(t)||curCfg.width,setStyle(ym_wins,{width:t+"px",height:e+"px",left:0,top:0}),n=getPos(n||curCfg.winPos),setStyle(ym_wins,{top:n[1]+"px",left:n[0]+"px"}),saveWinInfo(),setStyle(ym_body,"height",e-$height(ym_headbox)-$height(ym_btn)-$height(ym_bottom)+"px"),isCompat&&IE6&&curCfg.iframe&&setStyle(getPage(),{height:ym_body.clientHeight}))},_obj=[],cacheWin=[],winVisible=function(t){var e=!1===t?detachEvent:addEvent;if(e("scroll",curCfg.fixPosition&&!useFixed?scrollEvent:saveWinInfo,window),setStyle(ym_wins,"position",curCfg.fixPosition&&useFixed?"fixed":"absolute"),e("keydown",keydownEvent),!1!==t){for(var n=document.getElementsByTagName("object"),i=n.length-1;i>-1;i--)"hidden"!=n[i].style.visibility&&_obj.push(n[i])&&(n[i].style.visibility="hidden");setStyle([ym_hText,ym_hTool],"display",curCfg.titleBar?"":"none"),ym_head.className="ym-tc"+(curCfg.titleBar?"":" ym-ttc"),ym_hText.innerHTML=curCfg.title;i=0;for(var o=["min","max","close"];i<3;i++)ym_ico[i].style.display=curCfg[o[i]+"Btn"]?"":"none",ym_ico[i].title=curCfg[o[i]+"Txt"];var r="position:absolute;width:100%;height:100%;top:0;left:0;";curCfg.iframe&&top.$._crateLoading(),ym_body.innerHTML=curCfg.iframe?"<iframe style='"+r+"' onreadystatechange='stateChangeIE(this)' onload='stateChangeFirefox(this)' border='0' id='ymIframe' id='ymIframe' name='ymIframe' frameborder='0' src='"+curCfg.message+"'></iframe><div style='"+r+";display:none'></div>":'<div class="'+curCfg.msgCls+'">'+curCfg.message+"</div>",function(t,e){for(var n in e)try{t[n]=e[n]}catch(t){}}(ym_body.firstChild,curCfg.iframe),ym_body.className="ym-body "+curCfg.icoCls,setStyle(ym_btn,"display",(ym_btnContent.innerHTML=joinBtn(mkBtn(curCfg.btn)))?"":"none"),!curCfg.useSlide&&curCfg.showShadow&&setStyle(ym_shadow,"display",""),setStyle(ym_win,"display",""),doNormal(!0),filterWin(curCfg.useSlide?0:1),curCfg.useSlide&&function(){var t=0,e=function(){t=Math.min(t+curCfg.slideCfg.increment,1),filterWin(t),1==t&&(clearInterval(n),curCfg.showShadow&&setStyle(ym_shadow,"display",""))};e();var n=setInterval(e,curCfg.slideCfg.interval)}(),btnCache&&$(btnCache[btnIndex=0].id).focus(),ym_win.onselectstart=curCfg.allowSelect?null:keyEvent,ym_win.oncontextmenu=curCfg.allowRightMenu?null:keyEvent}else{setStyle(ym_shadow,"display","none");var a=function(){setStyle(ym_win,"display","none"),setStyle(_obj,"visibility","visible"),_obj=[],cacheWin.shift(),cacheWin.length&&ymPrompt.show.apply(null,cacheWin[0].concat(!0))};curCfg.useSlide?function(){var t=1,e=function(){t=Math.max(t-curCfg.slideCfg.increment,0),filterWin(t),0==t&&(maskVisible(!1),a(),clearInterval(n))};e();var n=setInterval(e,curCfg.slideCfg.interval)}():a()}},init=function(){ym_wins=[ym_win].concat(curCfg.showShadow?ym_shadow:""),maskVisible(),winVisible()},destroy=function(){!curCfg.useSlide&&maskVisible(!1),winVisible(!1)},getPage=function(){return curCfg.iframe?ym_body.firstChild:null},t;for(var i in ymPrompt.apply(ymPrompt,{close:destroy,max:max,min:min,normal:doNormal,getPage:getPage,show:function(t,e,n){if(!(!n&&cacheWin.push([t,e])&&cacheWin.length>1)){var i=[].slice.call(t,0),o={},r=-1;if(isObj(i[0]))o=i[0];else for(var a in dftCfg)i[++r]&&(o[a]=i[r]);for(var a in ymPrompt.apply(curCfg,ymPrompt.apply({},o,e),ymPrompt.setDefaultCfg()),curCfg)curCfg[a]=null!=curCfg[a]?curCfg[a]:ymPrompt.cfg[a];init()}},doHandler:function(t,e,n){(null==e?curCfg.autoClose:e)&&destroy();try{curCfg.handler(t)}catch(t){destroy()}},resizeWin:setWinSize,setDefaultCfg:function(t){return ymPrompt.cfg=ymPrompt.apply({},t,ymPrompt.apply({},ymPrompt.cfg,dftCfg))},getButtons:function(){for(var t,e=btnCache||[],n=[];t=e.shift();)n.push($(t.id));return n}}),ymPrompt.setDefaultCfg(),_initFn)for(;t=_initFn[i].shift();)ymPrompt[i].apply(null,t);addEvent("unload",function(){for(;ymPrompt.eventList.length;)detachEvent.apply(null,ymPrompt.eventList.shift())},window)}}()}}(),ymPrompt.apply(ymPrompt,{alert:function(){ymPrompt.show(arguments,{icoCls:"ymPrompt_alert",btn:["OK"]})},succeedInfo:function(){ymPrompt.show(arguments,{icoCls:"ymPrompt_succeed",btn:["OK"]})},errorInfo:function(){ymPrompt.show(arguments,{icoCls:"ymPrompt_error",btn:["OK"]})},confirmInfo:function(){ymPrompt.show(arguments,{icoCls:"ymPrompt_confirm",btn:["OK","CANCEL"]})},win:function(){ymPrompt.show(arguments)}});